# 建設土木ナレッジシステム 全体開発計画書

## 📋 プロジェクト概要

### 目的
施工計画・品質・安全・原価・出来形の知見を統合し、現場判断の速度と品質を高める建設土木会社向けナレッジ管理システムの開発

### 開発方針
1. **段階的開発**: プロトタイプ → 本番環境の順で段階的に実装
2. **品質重視**: 各フェーズでレビュー評価（数値化）を実施
3. **実用性優先**: 現場で即座に使える機能から優先実装

---

## 🎯 開発フェーズ全体像

### Phase A: プロトタイプ開発環境（全8フェーズ）✅ 完了

| フェーズ | 名称 | 状態 | 完了日 |
|---------|------|------|--------|
| A-1 | スコープ・課題定義 | ✅ 完了 | 2025-12-26 |
| A-2 | 情報設計・ナビゲーション設計 | ✅ 完了 | 2025-12-26 |
| A-3 | ワイヤーフレーム作成 | ✅ 完了 | 2025-12-26 |
| A-4 | ビジュアル設計・コンポーネント定義 | ✅ 完了 | 2025-12-26 |
| A-5 | 静的WebUI実装 | ✅ 完了 | 2025-12-26 |
| A-6 | 主要インタラクション実装 | ✅ 完了 | 2025-12-26 |
| A-7 | シナリオ検証・レビュー評価 | ✅ 完了 | 2025-12-26 |
| A-8 | 改善反映・本番移行要件整理 | ✅ 完了 | 2025-12-26 |

**総合評価**: 全シナリオ20点以上で合格 ✅

---

### Phase B: 本番環境開発（全10フェーズ）🚧 進行中

| フェーズ | 名称 | 状態 | 開始予定 | 完了予定 |
|---------|------|------|----------|----------|
| B-1 | 本番要件確定 | ✅ 完了 | 2025-12-26 | 2025-12-27 |
| B-2 | アーキテクチャ設計確定 | ✅ 完了 | 2025-12-27 | 2025-12-28 |
| B-3 | データ設計確定 | ✅ 完了 | 2025-12-28 | 2025-12-29 |
| B-4 | API設計確定 | ✅ 完了 | 2025-12-29 | 2025-12-30 |
| B-5 | バックエンド基盤実装 | ✅ 完了 | 2025-12-26 | 2026-01-05 |
| B-6 | 検索・通知機能実装 | 🔄 進行中（60%） | 2026-01-05 | 2026-01-10 |
| B-7 | WebUI統合実装 | 🔄 進行中（70%） | 2025-12-26 | 2026-01-15 |
| B-8 | セキュリティ/権限/監査強化 | 🔄 着手 | 2026-01-15 | 2026-01-20 |
| B-9 | 品質保証・受入テスト | 🔄 着手 | 2026-01-20 | 2026-01-25 |
| B-10 | 展開準備・運用引継ぎ | 📋 計画中 | 2026-01-25 | 2026-01-31 |

**現在地**: フェーズ B-6/B-7 を並行実施中、B-8/B-9 を着手

---

## 📊 現在の実装状況（2025-12-26時点）

### ✅ 完了済み

#### バックエンド
- Flask APIサーバー基盤
- RESTful APIエンドポイント
  - ナレッジ管理 (CRUD)
  - SOP管理 (R)
  - 法令管理 (R)
  - 事故レポート管理 (CR)
  - 専門家相談 (CR)
  - 承認フロー (承認/却下)
  - ダッシュボード統計
- JSONベースデータストレージ
- CORS対応（ネットワークアクセス可能）

#### フロントエンド
- ダッシュボード画面（index.html）
- 詳細画面（5画面）
- 管理画面（admin.html）
- 動的データ表示
- 検索機能
- タブ切替
- 新規登録機能
- IPアドレス対応

#### ドキュメント
- 要件定義書
- 機能設計書
- UI/UX設計書
- データモデル
- 開発計画書（13カテゴリ、45ファイル）

### 🔄 進行中

#### Phase B-6: 検索・通知機能実装
- [x] ログイン機能実装
- [ ] 検索強化（全文検索/フィルタ拡張/ページネーション）
- [ ] 通知配信（メール/チャット連携 or 内部通知）
- [ ] 検索履歴/条件保持

#### Phase B-7: WebUI統合実装
- [x] 認証統合（JWTヘッダー付与）
- [ ] 管理画面の認証対応
- [ ] 権限に応じたUI表示制御
- [ ] 他ページへの認証チェック統合（詳細/管理系）

#### Phase B-8: セキュリティ/権限/監査強化
- [x] JWT秘密鍵の環境変数化
- [x] セキュリティヘッダーの追加
- [ ] HTTPS対応
- [ ] CSRF対策
- [ ] レート制限
- [ ] 監査ログ保全（長期保管）

#### Phase B-9: 品質保証・受入テスト
- [x] pytest基盤の追加
- [x] 認証/認可の初期単体テスト
- [ ] 結合テスト/シナリオテストの拡充
- [ ] カバレッジ計測

### 📋 未着手（主要残課題）

- データベース移行（JSON → PostgreSQL/MySQL）
- 全文検索エンジン統合（Elasticsearch等）
- 通知機能（メール/チャット連携）
- パフォーマンス最適化
- CI/CDパイプライン
- 本番環境構築

---

## 🎯 Phase B-1: 本番要件確定（詳細）

### 目的
プロトタイプで検証した内容を元に、本番に必要な機能・非機能要件を確定する

### 実施内容

#### 1. 機能要件の確定 ✅

**高優先度（Phase B-5までに実装）**
- [x] ナレッジ検索・閲覧（基本実装済み）
- [x] 承認フロー可視化（基本実装済み）
- [x] 役割ベースアクセス制御（RBAC）
- [x] 監査ログ記録
- [ ] 検索条件の保持・履歴管理
- [ ] 関連ナレッジの自動提示

**中優先度（Phase B-6で実装）**
- [ ] 全文検索の高速化
- [ ] 通知配信（メール/チャット）
- [ ] ナレッジ推薦機能
- [ ] ダッシュボードのリアルタイム更新

**低優先度（Phase B-7以降）**
- [ ] モバイル対応の最適化
- [ ] オフライン閲覧機能
- [ ] AIによるナレッジ分類支援
- [ ] 3Dモデル連携

#### 2. 非機能要件の具体化 ✅

| 要件カテゴリ | 目標値 | 現状 | ギャップ |
|-------------|-------|------|---------|
| **性能** | | | |
| 主要画面表示 | 3秒以内 | 1秒程度 | ✅ 達成 |
| 検索応答 | 2秒以内 | 1秒以内 | ✅ 達成 |
| 同時接続数 | 300名 | 未検証 | 要検証 |
| **可用性** | | | |
| 月間稼働率 | 99.5%以上 | 未測定 | 要構築 |
| RTO（復旧時間） | 4時間 | 未定義 | 要構築 |
| RPO（データ損失） | 24時間 | 未定義 | 要構築 |
| **セキュリティ** | | | |
| 通信暗号化 | TLS 1.2以上 | HTTP | 要実装 |
| 認証方式 | SSO/LDAP | なし | 要実装 |
| 権限管理 | RBAC | なし | 要実装 |
| **監査** | | | |
| 操作ログ保管 | 7年間 | なし | 要実装 |
| 配信履歴保管 | 5年間 | なし | 要実装 |

#### 3. 前提・依存関係の整理 ✅

**依存する外部システム**
- メールサーバー（通知配信用）
- チャット/コラボレーションツール（Slack/Teams等）
- 認証基盤（SSO/LDAP）
- バックアップシステム

**必要なマスタデータ**
- 工種マスタ
- 工区マスタ
- 発注者マスタ
- 組織・部門マスタ
- ユーザー・権限マスタ

**既存データ移行**
- 既存SOP（56件想定）
- 法令・規格（24件想定）
- 過去の事故レポート
- 施工計画書・ナレッジ

---

## 📈 KPI・成功指標

### プロジェクトKPI

| 指標 | 目標値 | 測定方法 |
|-----|-------|---------|
| ナレッジ再利用率 | 70%以上 | 検索→閲覧→引用の追跡 |
| 事故ゼロ継続日数 | 維持 | 事故レポート登録なし日数 |
| 承認リードタイム短縮 | 30%短縮 | 申請→承認完了の時間 |
| 重要ナレッジ周知 | 48時間以内 | 配信→全員既読の時間 |

### 開発プロセスKPI

| 指標 | 目標値 |
|-----|-------|
| 各フェーズレビュー評価 | 20点以上/25点満点 |
| コードカバレッジ | 80%以上 |
| バグ密度 | 0.5件/KLOC以下 |
| システム稼働率 | 99.5%以上 |

---

## 🚀 Next Actions（直近のアクション）

### Phase B-6/B-7 完了に向けて

1. **検索強化の設計と実装** 🔍
   - 全文検索/フィルタ/ページネーション
   - 検索条件の保持/履歴

2. **通知配信の方式確定と実装** 🔔
   - メール/チャット連携方針
   - 内部通知ストアの設計

3. **管理画面の認証・権限UI** 🛡️
   - admin権限の適用
   - 権限に応じた表示制御

4. **Phase B-8/B-9着手準備** 🧪
   - セキュリティ強化の初期対応
   - テスト基盤のセットアップ

---

## 📝 レビュー評価基準（フェーズB-1）

| 観点 | 評価項目 | 配点 |
|-----|---------|-----|
| **完成度** | 要件が具体的で実装可能なレベルまで定義されているか | 5点 |
| **一貫性** | 要件間に矛盾がなく、優先度が明確か | 5点 |
| **実現性** | 技術的に実現可能で、リソース内で完了できるか | 5点 |
| **リスク** | リスクが特定され、対策が計画されているか | 5点 |
| **受入準備** | 受入基準が明確で、テスト計画の土台ができているか | 5点 |

**合格基準**: 20点以上/25点満点

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 担当 |
| --- | --- | --- | --- |
| 2025-12-26 | 1.0 | 初版作成、Phase A完了・Phase B開始を反映 | System |
