# 新機能障害対応手順

## 概要
新機能（ナレッジ共有機能）の障害発生時の対応手順です。

## 障害レベル定義

| レベル | 定義 | 対応時間 | 例 |
|--------|------|----------|-----|
| P0 | 新機能完全停止 | 15分以内 | APIダウン |
| P1 | 新機能機能制限 | 1時間以内 | 検索遅延 |
| P2 | 新機能軽微障害 | 4時間以内 | 表示エラー |

## 障害対応フロー

```
1. 障害検知
   ↓
2. 影響評価
   ↓
3. 即時対応
   ↓
4. 根本原因分析
   ↓
5. 恒久対策
   ↓
6. 事後レビュー
```

## 即時対応手順

### P0: 新機能完全停止
1. アラート確認
2. サービスステータス確認
   ```bash
   systemctl status mks-backend
   ```
3. ログ確認
   ```bash
   tail -f /var/log/mks/new-feature-error.log
   ```
4. サービス再起動
   ```bash
   sudo systemctl restart mks-backend
   ```
5. ヘルスチェック実行
   ```bash
   bash scripts/new-feature-health-check.sh
   ```

### P1: 新機能機能制限
1. パフォーマンス監視
2. 負荷分散調整
3. キャッシュクリア
4. 一時的な回避策適用

### P2: 新機能軽微障害
1. エラーログ分析
2. 設定確認
3. 軽微修正適用

## 根本原因分析
- ログ分析
- データベースクエリ確認
- ネットワークチェック
- コードレビュー

## 恒久対策
- コード修正
- 設定変更
- テスト追加
- ドキュメント更新

## 事後レビュー
- 障害レポート作成
- 改善策策定
- チーム共有
- Runbook更新

## 関連リソース
- 監視ダッシュボード: http://monitoring.example.com
- ログビューア: http://logs.example.com
- 障害管理システム: JIRA/Redmine