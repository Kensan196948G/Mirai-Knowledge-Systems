# ======================================
# Mirai Knowledge Systems - 環境変数設定例
# ======================================
# このファイルを .env にコピーして使用してください
# cp .env.example .env

# --------------------------------------
# セキュリティ設定（必須）
# --------------------------------------

# JWT秘密鍵（必須: 最低32文字以上の安全なランダム文字列）
# 生成例: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
# 注意: 本番環境では必ず以下のコマンドで安全な鍵を生成してください
#       python3 -c "import secrets; print('MKS_JWT_SECRET_KEY=' + secrets.token_urlsafe(32))" >> .env
MKS_JWT_SECRET_KEY=your-secure-random-jwt-secret-key-minimum-32-characters

# --------------------------------------
# 環境設定
# --------------------------------------

# 環境モード (development | production)
# 本番環境では production を設定
MKS_ENV=development

# デバッグモード (true | false)
# 本番環境では必ず false に設定
MKS_DEBUG=false

# --------------------------------------
# HTTPS/SSL設定
# --------------------------------------

# HTTPS強制リダイレクト (true | false)
# 本番環境では自動的に true がデフォルトになります
# 開発環境で有効化する場合のみ設定
# MKS_FORCE_HTTPS=false

# リバースプロキシのヘッダーを信頼 (true | false)
# Nginx等のリバースプロキシ経由でデプロイする場合は true
MKS_TRUST_PROXY_HEADERS=false

# HSTS有効化 (true | false)
# HTTPS環境でのみ有効
MKS_HSTS_ENABLED=false

# HSTS有効期間（秒）
# デフォルト: 31536000 (1年)
MKS_HSTS_MAX_AGE=31536000

# HSTSサブドメイン含有 (true | false)
MKS_HSTS_INCLUDE_SUBDOMAINS=true

# --------------------------------------
# CORS設定
# --------------------------------------

# 許可するオリジン（カンマ区切り）
CORS_ORIGINS=http://localhost:5100,http://127.0.0.1:5100

# --------------------------------------
# データストレージ
# --------------------------------------

# PostgreSQL使用フラグ (true | false)
# true: PostgreSQL使用、false: JSON使用
MKS_USE_POSTGRESQL=false

# PostgreSQL接続URL
# 形式: postgresql://[user]:[password]@[host]:[port]/[database]
DATABASE_URL=postgresql://postgres:password@localhost:5432/mirai_knowledge_db

# PostgreSQL接続プール設定
MKS_DB_POOL_SIZE=10
MKS_DB_MAX_OVERFLOW=20
MKS_DB_POOL_TIMEOUT=30
MKS_DB_POOL_RECYCLE=3600
MKS_DB_ECHO=false

# JSONデータ保存先ディレクトリ（PostgreSQL未使用時）
# 未設定の場合は backend/data を使用
MKS_DATA_DIR=backend/data

# --------------------------------------
# 外部通知設定（オプション）
# --------------------------------------

# Microsoft Teams Webhook URL
# MKS_TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/...

# SMTP設定（メール通知用）
# MKS_SMTP_HOST=smtp.example.com
# MKS_SMTP_PORT=587
# MKS_SMTP_FROM=noreply@example.com
# MKS_SMTP_USER=smtp_username
# MKS_SMTP_PASSWORD=smtp_password
# MKS_SMTP_USE_TLS=true
# MKS_SMTP_USE_SSL=false

# 外部通知の無効化 (true | false)
# テスト環境で外部通知を無効にする場合
MKS_DISABLE_EXTERNAL_NOTIFICATIONS=false

# 外部通知を送信する通知タイプ（カンマ区切り）
# 未設定の場合は全てのタイプを送信
# MKS_EXTERNAL_NOTIFICATION_TYPES=approval_required,incident_reported

# 通知送信リトライ回数
MKS_NOTIFICATION_RETRY_COUNT=5

# --------------------------------------
# Microsoft 365 / Azure AD 連携設定
# --------------------------------------

# Azure AD アプリ登録設定
# Azure Portal > Azure Active Directory > アプリの登録 から取得
# 参考: https://learn.microsoft.com/ja-jp/graph/auth-register-app-v2

# テナントID（ディレクトリID）
AZURE_TENANT_ID=your-tenant-id

# クライアントID（アプリケーションID）
AZURE_CLIENT_ID=your-client-id

# クライアントシークレット（証明書認証を推奨）
# 本番環境では証明書認証（AZURE_CLIENT_CERTIFICATE_PATH）を使用してください
AZURE_CLIENT_SECRET=your-client-secret

# 証明書認証（推奨: 本番環境）
# OpenSSLで証明書を生成: openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
# AZURE_CLIENT_CERTIFICATE_PATH=/etc/ssl/mks/azure_app_cert.pem
# AZURE_CLIENT_CERTIFICATE_KEY_PATH=/etc/ssl/mks/azure_app_key.pem

# Microsoft Graph API 権限（Azure AD で設定が必要）
# - User.Read.All: ユーザー情報取得
# - Sites.Read.All: SharePointサイト読み取り
# - Files.Read.All: OneDrive/SharePointファイル読み取り
# - ChannelMessage.Send: Teamsメッセージ送信（委任のみ）

# SharePointサイトURL（データインポート用）
# MKS_SHAREPOINT_SITE_URL=https://contoso.sharepoint.com/sites/construction

# Teams通知用チャネルWebhook URL
# MKS_TEAMS_CHANNEL_WEBHOOK_URL=https://outlook.office.com/webhook/...

# --------------------------------------
# 外部API設定（オプション）
# --------------------------------------

# Brave Search API Key
# https://brave.com/search/api/ から取得
MKS_BRAVE_SEARCH_API_KEY=

# --------------------------------------
# 開発環境専用設定
# --------------------------------------

# レート制限（本番環境のみ有効）
# 開発環境では自動的に無効化されます
