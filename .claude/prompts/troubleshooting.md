# 障害対応用プロンプト

## 緊急対応セッション開始

```
以降、日本語で対応願います。

## 緊急対応モード
これは本番障害対応です。迅速かつ慎重に作業してください。

## 障害情報
発生日時: [YYYY-MM-DD HH:MM]
影響範囲: [影響を受けているユーザー/機能]
現象: [障害の症状]

## 対応ルール
1. まず影響範囲を特定
2. 暫定対応（サービス復旧優先）
3. 根本原因調査
4. 恒久対応計画

## 禁止事項
- 本番データの削除
- 設定の大規模変更
- 事前確認なしのサービス再起動

すぐに調査を開始してください。
```

## 調査パターン

### サービス停止
```
バックエンドサービスが停止しています。調査してください。

確認手順：
1. systemctl status mks-backend
2. journalctl -u mks-backend -n 100
3. curl -s http://localhost:5100/api/v1/health
4. プロセス確認: ps aux | grep python
5. ポート確認: ss -tlnp | grep 5100

復旧手順を提示してください。
```

### データベース接続エラー
```
データベース接続エラーが発生しています。

確認手順：
1. PostgreSQLステータス: systemctl status postgresql
2. 接続テスト: pg_isready -h localhost
3. ログ確認: tail -50 /var/log/postgresql/*.log
4. 接続数確認

復旧手順を提示してください。
```

### 高負荷・レスポンス遅延
```
システムのレスポンスが遅くなっています。

確認手順：
1. CPU/メモリ使用率: top または htop
2. ディスクI/O: iostat
3. データベース接続数
4. スロークエリログ
5. アクセスログ分析

ボトルネックを特定してください。
```

### 認証エラー
```
ユーザーがログインできない状態です。

確認手順：
1. JWT設定確認（MKS_JWT_SECRET_KEY）
2. ユーザーテーブル確認
3. 認証ログ確認
4. トークン有効期限確認

原因と復旧手順を提示してください。
```

### 500エラー
```
APIが500エラーを返しています。

確認手順：
1. エラーログ確認
2. スタックトレース確認
3. 直近の変更確認
4. 再現テスト

原因特定と修正方法を提示してください。
```

## 復旧後の対応
```
障害が復旧しました。以下を実施してください：

1. 根本原因の文書化
2. 再発防止策の検討
3. 監視強化の検討
4. 変更履歴の更新
```
