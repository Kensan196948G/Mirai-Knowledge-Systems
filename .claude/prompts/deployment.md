# デプロイ作業用プロンプト

## セッション開始時に使用

```
以降、日本語で対応願います。

## 環境情報
- 本番サーバー: Ubuntu 24.04 LTS
- サービス管理: systemd (mks-backend)
- Webサーバー: Nginx
- データベース: PostgreSQL 16

## デプロイルール
1. 本番デプロイ前に全テストPASS確認
2. バックアップ取得必須
3. ロールバック手順を準備
4. 段階的デプロイ（可能な場合）

## 禁止事項
- Docker使用禁止
- テスト未実施でのデプロイ
- 営業時間中の大規模変更

## 今回のデプロイ作業
[ここに具体的な作業内容を記載]
```

## デプロイパターン

### 通常リリース
```
以下の変更を本番環境にデプロイしてください：

変更内容:
- [変更1]
- [変更2]

デプロイ手順：
1. テスト実行確認
2. データベースバックアップ
3. コードプル
4. マイグレーション（必要時）
5. サービス再起動
6. 動作確認
7. 監視確認
```

### ホットフィックス
```
緊急修正をデプロイしてください：

問題: [障害内容]
修正: [修正内容]

手順：
1. 修正ブランチ作成
2. 修正実装
3. テスト実行
4. 本番デプロイ
5. 動作確認
6. main/masterへマージ
```

### ロールバック
```
直前のデプロイをロールバックしてください：

理由: [ロールバック理由]

手順：
1. 問題の切り分け
2. 前バージョンへ戻す
3. DBロールバック（必要時）
4. サービス再起動
5. 動作確認
```

## 環境構築

### 新規サーバーセットアップ
```
新規サーバーの初期セットアップを行ってください：

手順：
1. Python環境構築
2. PostgreSQL設定
3. Nginx設定
4. SSL証明書設定
5. systemd設定
6. 監視設定
7. バックアップ設定
```

### 環境変数設定
```
本番環境の環境変数を設定してください：

必須変数：
- MKS_ENV=production
- DATABASE_URL
- MKS_JWT_SECRET_KEY

確認手順：
1. /etc/systemd/system/mks-backend.service確認
2. 環境変数反映確認
3. サービス再起動
```

## 監視・アラート

### 監視設定確認
```
本番環境の監視設定を確認してください：

確認項目：
- ヘルスチェック: /api/v1/health
- データベース監視: /api/v1/health/db
- ディスク使用率
- メモリ使用率
- エラーログ監視
```

### アラート設定
```
以下のアラート設定を確認・追加してください：

アラート条件：
- サービス停止
- エラー率上昇
- レスポンス遅延
- ディスク容量警告
```

## コミット・PR・マージ
```
変更をコミットしてPRを作成し、マージしてください：

/commit-push-pr-merge

コミットメッセージ:
[変更内容の要約]
```
