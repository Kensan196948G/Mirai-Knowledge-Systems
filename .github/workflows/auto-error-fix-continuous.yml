name: ğŸ¤– è‡ªå‹•ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ5åˆ†é–“éš”ãƒ»ç„¡é™ãƒ«ãƒ¼ãƒ—ï¼‰

on:
  # 5åˆ†ã”ã¨ã«è‡ªå‹•å®Ÿè¡Œï¼ˆ15å›ãƒ«ãƒ¼ãƒ—å®Ÿè¡Œå¾Œã€æ¬¡ã®ãƒˆãƒªã‚¬ãƒ¼ã¾ã§5åˆ†å¾…æ©Ÿï¼‰
  schedule:
    - cron: '*/5 * * * *'  # æ¯5åˆ†ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ ï¼‰

  # ä»–ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº†æ™‚ã«ãƒˆãƒªã‚¬ãƒ¼ï¼ˆã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ç”¨ï¼‰
  workflow_run:
    workflows:
      - "E2E Tests"
      - "Backend CI"
      - "Backend CI (Improved)"
      - "Mirai Knowledge Systems CI/CD"
    types:
      - completed

  # æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼
  workflow_dispatch:
    inputs:
      max_loops:
        description: 'æœ€å¤§ãƒ«ãƒ¼ãƒ—å›æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 15ï¼‰'
        required: false
        default: '15'
      create_issue:
        description: 'Issueä½œæˆï¼ˆyes/noï¼‰'
        required: false
        default: 'yes'

env:
  MAX_LOOPS: 15
  PYTHON_VERSION: '3.12'

jobs:
  auto-error-detection-and-fix:
    name: ã‚¨ãƒ©ãƒ¼è‡ªå‹•æ¤œçŸ¥ãƒ»ä¿®å¾©ï¼ˆ15å›ãƒ«ãƒ¼ãƒ—ï¼‰
    runs-on: ubuntu-latest

    permissions:
      contents: read
      pull-requests: write
      checks: write
      statuses: write
      issues: write  # Issueã®ä½œæˆã«å¿…è¦
      actions: read  # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çŠ¶æ…‹ã®èª­ã¿å–ã‚Šã«å¿…è¦

    steps:
      - name: ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ãƒˆãƒªã‚¬ãƒ¼å…ƒãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çŠ¶æ…‹ç¢ºèª
        if: github.event_name == 'workflow_run'
        id: check_trigger
        uses: actions/github-script@v7
        with:
          script: |
            const workflowRun = context.payload?.workflow_run;
            if (!workflowRun) {
              core.setFailed('workflow_runæƒ…å ±ãŒãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
              return;
            }

            console.log(`ãƒˆãƒªã‚¬ãƒ¼å…ƒ: ${workflowRun.name}`);
            console.log(`çŠ¶æ…‹: ${workflowRun.conclusion}`);
            console.log(`URL: ${workflowRun.html_url}`);

            core.setOutput('workflow_name', workflowRun.name);
            core.setOutput('workflow_conclusion', workflowRun.conclusion);
            core.setOutput('workflow_url', workflowRun.html_url);
            core.setOutput('workflow_run_id', workflowRun.id);

            // ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®çµæœã«å¿œã˜ã¦å‡¦ç†
            switch (workflowRun.conclusion) {
              case 'failure':
                core.warning(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚è‡ªå‹•ä¿®å¾©ã‚’è©¦è¡Œã—ã¾ã™ã€‚`);
                return 'failure';
              case 'success':
                core.info(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯æˆåŠŸã—ã¾ã—ãŸã€‚`);
                return 'success';
              case 'cancelled':
                core.info(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸã€‚`);
                return 'cancelled';
              case 'skipped':
                core.info(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸã€‚`);
                return 'skipped';
              case 'timed_out':
                core.warning(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚`);
                return 'timed_out';
              case 'action_required':
                core.warning(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã§ã™ã€‚`);
                return 'action_required';
              case 'neutral':
                core.info(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã¯ä¸­ç«‹çš„ãªçµæœã§ã™ã€‚`);
                return 'neutral';
              default:
                core.warning(`ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ "${workflowRun.name}" ã®çµæœãŒä¸æ˜ã§ã™: ${workflowRun.conclusion}`);
                return workflowRun.conclusion;
            }

      - name: Pythonç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'

      - name: ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        working-directory: ./backend
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then
            pip install -r requirements.txt
          fi

      - name: PostgreSQLèµ·å‹•ï¼ˆDockerï¼‰
        run: |
          docker run -d \
            --name postgres \
            -e POSTGRES_USER=mks_user \
            -e POSTGRES_PASSWORD=mks_password \
            -e POSTGRES_DB=mks_db \
            -p 5432:5432 \
            postgres:16-alpine

          # PostgreSQLèµ·å‹•å¾…æ©Ÿ
          for i in {1..30}; do
            if docker exec postgres pg_isready -U mks_user; then
              echo "PostgreSQL is ready!"
              break
            fi
            echo "Waiting for PostgreSQL... ($i/30)"
            sleep 2
          done

      - name: Redisèµ·å‹•ï¼ˆDockerï¼‰
        run: |
          docker run -d \
            --name redis \
            -p 6379:6379 \
            redis:7-alpine

          # Redisèµ·å‹•å¾…æ©Ÿ
          sleep 5

      - name: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
        working-directory: ./backend
        env:
          DATABASE_URL: postgresql://mks_user:mks_password@localhost:5432/mks_db
          REDIS_URL: redis://localhost:6379/0
        run: |
          python -c "from app_v2 import db, app; app.app_context().push(); db.create_all(); print('Database initialized')" || echo "Database already exists"

      - name: ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©ãƒ«ãƒ¼ãƒ—ï¼ˆ15å›ï¼‰
        id: error_fix_loop
        working-directory: ./backend
        env:
          DATABASE_URL: postgresql://mks_user:mks_password@localhost:5432/mks_db
          REDIS_URL: redis://localhost:6379/0
          PGHOST: localhost
          PGPORT: 5432
          MKS_PORT: 5100
          MKS_ENV: test
          MKS_SKIP_HTTP_CHECK: true
        run: |
          echo "==================================="
          echo "ã‚¨ãƒ©ãƒ¼è‡ªå‹•æ¤œçŸ¥ãƒ»ä¿®å¾©é–‹å§‹"
          echo "æœ€å¤§ãƒ«ãƒ¼ãƒ—å›æ•°: ${{ github.event.inputs.max_loops || env.MAX_LOOPS }}"
          echo "==================================="
          echo ""

          # ãƒ«ãƒ¼ãƒ—ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
          LOOP_COUNT=0
          MAX_LOOPS=${{ github.event.inputs.max_loops || env.MAX_LOOPS }}
          ERROR_COUNT=0
          FIX_COUNT=0

          # çµæœãƒ•ã‚¡ã‚¤ãƒ«
          RESULT_FILE="${GITHUB_WORKSPACE}/error_fix_results.txt"
          echo "# ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©ãƒ­ã‚°" > "$RESULT_FILE"
          echo "å®Ÿè¡Œæ—¥æ™‚: $(date '+%Y-%m-%d %H:%M:%S')" >> "$RESULT_FILE"
          echo "æœ€å¤§ãƒ«ãƒ¼ãƒ—å›æ•°: ${MAX_LOOPS}" >> "$RESULT_FILE"
          echo "" >> "$RESULT_FILE"

          while [ $LOOP_COUNT -lt $MAX_LOOPS ]; do
            LOOP_COUNT=$((LOOP_COUNT + 1))
            echo "----------------------------------------"
            echo "ãƒ«ãƒ¼ãƒ— ${LOOP_COUNT}/${MAX_LOOPS}"
            echo "----------------------------------------"
            echo "## ãƒ«ãƒ¼ãƒ— ${LOOP_COUNT}/${MAX_LOOPS}" >> "$RESULT_FILE"

            # 1. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
            echo "[STEP 1] ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­..."
            if python scripts/health_monitor.py > health_check.log 2>&1; then
              echo "âœ“ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Œäº†"
              cat health_check.log >> "$RESULT_FILE"
            else
              echo "âœ— ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼æ¤œå‡º"
              ERROR_COUNT=$((ERROR_COUNT + 1))
              cat health_check.log >> "$RESULT_FILE"
            fi

            # 2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ï¼‰
            echo "[STEP 2] ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­..."
            if pytest tests/ -v --tb=short > test_results.log 2>&1; then
              echo "âœ“ å…¨ãƒ†ã‚¹ãƒˆåˆæ ¼"
              echo "### ãƒ†ã‚¹ãƒˆçµæœ: åˆæ ¼" >> "$RESULT_FILE"
            else
              echo "âœ— ãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’æ¤œå‡º"
              ERROR_COUNT=$((ERROR_COUNT + 1))
              echo "### ãƒ†ã‚¹ãƒˆçµæœ: å¤±æ•—" >> "$RESULT_FILE"
              grep -A 3 "FAILED" test_results.log >> "$RESULT_FILE" || true

              # 3. è‡ªå‹•ä¿®å¾©è©¦è¡Œ
              echo "[STEP 3] è‡ªå‹•ä¿®å¾©ã‚’è©¦è¡Œä¸­..."
              if python scripts/auto_fix_daemon.py --once >> "$RESULT_FILE" 2>&1; then
                echo "âœ“ è‡ªå‹•ä¿®å¾©å®Œäº†"
                FIX_COUNT=$((FIX_COUNT + 1))
              else
                echo "âœ— è‡ªå‹•ä¿®å¾©å¤±æ•—"
                echo "### è‡ªå‹•ä¿®å¾©: å¤±æ•—" >> "$RESULT_FILE"
              fi
            fi

            # 4. ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
            echo "[STEP 4] ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªä¸­..."
            if [ -f logs/app.log ]; then
              ERROR_LINES=$(grep -i "error\|exception\|critical" logs/app.log | tail -10 || true)
              if [ -n "$ERROR_LINES" ]; then
                echo "âœ— ãƒ­ã‚°ã«ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡º"
                ERROR_COUNT=$((ERROR_COUNT + 1))
                echo "### ãƒ­ã‚°ã‚¨ãƒ©ãƒ¼:" >> "$RESULT_FILE"
                echo "$ERROR_LINES" >> "$RESULT_FILE"
              else
                echo "âœ“ ãƒ­ã‚°ã«ã‚¨ãƒ©ãƒ¼ãªã—"
              fi
            fi

            echo ""
            echo "ãƒ«ãƒ¼ãƒ— ${LOOP_COUNT} å®Œäº† - ã‚¨ãƒ©ãƒ¼: ${ERROR_COUNT}, ä¿®å¾©: ${FIX_COUNT}"
            echo "" >> "$RESULT_FILE"

            # æœ€å¾Œã®ãƒ«ãƒ¼ãƒ—ã§ãªã‘ã‚Œã°5ç§’å¾…æ©Ÿ
            if [ $LOOP_COUNT -lt $MAX_LOOPS ]; then
              sleep 5
            fi
          done

          echo "==================================="
          echo "ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©å®Œäº†"
          echo "ç·ãƒ«ãƒ¼ãƒ—å›æ•°: ${LOOP_COUNT}"
          echo "æ¤œå‡ºã‚¨ãƒ©ãƒ¼æ•°: ${ERROR_COUNT}"
          echo "ä¿®å¾©å®Ÿè¡Œå›æ•°: ${FIX_COUNT}"
          echo "==================================="

          # ã‚µãƒãƒªãƒ¼ã‚’çµæœãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
          echo "" >> "$RESULT_FILE"
          echo "---" >> "$RESULT_FILE"
          echo "## ã‚µãƒãƒªãƒ¼" >> "$RESULT_FILE"
          echo "- ç·ãƒ«ãƒ¼ãƒ—å›æ•°: ${LOOP_COUNT}" >> "$RESULT_FILE"
          echo "- æ¤œå‡ºã‚¨ãƒ©ãƒ¼æ•°: ${ERROR_COUNT}" >> "$RESULT_FILE"
          echo "- ä¿®å¾©å®Ÿè¡Œå›æ•°: ${FIX_COUNT}" >> "$RESULT_FILE"

          # GitHubç’°å¢ƒå¤‰æ•°ã«è¨­å®š
          echo "error_count=${ERROR_COUNT}" >> $GITHUB_OUTPUT
          echo "fix_count=${FIX_COUNT}" >> $GITHUB_OUTPUT
          echo "loop_count=${LOOP_COUNT}" >> $GITHUB_OUTPUT

      - name: çµæœãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        id: generate_report
        run: |
          REPORT_FILE="${GITHUB_WORKSPACE}/error_fix_report.md"

          cat > "$REPORT_FILE" << 'REPORT_EOF'
          # ğŸ¤– è‡ªå‹•ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©ãƒ¬ãƒãƒ¼ãƒˆ

          **å®Ÿè¡Œæ—¥æ™‚:** $(date '+%Y-%m-%d %H:%M:%S UTC')
          **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼Run:** #${{ github.run_number }}
          **ã‚³ãƒŸãƒƒãƒˆ:** ${{ github.sha }}
          **ãƒˆãƒªã‚¬ãƒ¼:** ${{ github.event_name }}
          REPORT_EOF

          # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒˆãƒªã‚¬ãƒ¼ã®å ´åˆã€ãƒˆãƒªã‚¬ãƒ¼å…ƒæƒ…å ±ã‚’è¿½åŠ 
          if [ "${{ github.event_name }}" == "workflow_run" ]; then
            cat >> "$REPORT_FILE" << 'TRIGGER_EOF'

          ## ğŸ”” ãƒˆãƒªã‚¬ãƒ¼å…ƒãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

          | é …ç›® | å€¤ |
          |------|-----|
          | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å | ${{ steps.check_trigger.outputs.workflow_name }} |
          | å®Ÿè¡Œçµæœ | ${{ steps.check_trigger.outputs.workflow_conclusion }} |
          | URL | ${{ steps.check_trigger.outputs.workflow_url }} |
          TRIGGER_EOF
          fi

          cat >> "$REPORT_FILE" << 'REPORT_EOF'

          ## ğŸ“Š å®Ÿè¡Œçµæœ

          | é …ç›® | å€¤ |
          |------|-----|
          | ãƒ«ãƒ¼ãƒ—å›æ•° | ${{ steps.error_fix_loop.outputs.loop_count }} / ${{ github.event.inputs.max_loops || env.MAX_LOOPS }} |
          | æ¤œå‡ºã‚¨ãƒ©ãƒ¼æ•° | ${{ steps.error_fix_loop.outputs.error_count }} |
          | ä¿®å¾©å®Ÿè¡Œå›æ•° | ${{ steps.error_fix_loop.outputs.fix_count }} |

          ## ğŸ“‹ è©³ç´°ãƒ­ã‚°

          REPORT_EOF

          # è©³ç´°ãƒ­ã‚°ã‚’è¿½åŠ 
          cat "${GITHUB_WORKSPACE}/error_fix_results.txt" >> "$REPORT_FILE" || echo "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“" >> "$REPORT_FILE"

          echo "report_path=${REPORT_FILE}" >> $GITHUB_OUTPUT

      - name: GitHub Issueã«çµæœã‚’æŠ•ç¨¿
        if: always() && github.event.inputs.create_issue != 'no'
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const errorCount = '${{ steps.error_fix_loop.outputs.error_count }}';
            const fixCount = '${{ steps.error_fix_loop.outputs.fix_count }}';
            const loopCount = '${{ steps.error_fix_loop.outputs.loop_count }}';
            const eventName = '${{ github.event_name }}';
            const workflowName = '${{ steps.check_trigger.outputs.workflow_name }}';
            const workflowConclusion = '${{ steps.check_trigger.outputs.workflow_conclusion }}';

            // ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
            let reportBody = 'è©³ç´°ãƒ­ã‚°ã¯æ·»ä»˜ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
            try {
              reportBody = fs.readFileSync('${{ steps.generate_report.outputs.report_path }}', 'utf8');
            } catch (e) {
              console.log('ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
            }

            // Issueã‚¿ã‚¤ãƒˆãƒ«
            const dateStr = new Date().toISOString().split('T')[0];

            let title;
            if (eventName === 'workflow_run' && (workflowConclusion === 'failure' || workflowConclusion === 'timed_out')) {
              // ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åã‚’ã‚µãƒ‹ã‚¿ã‚¤ã‚ºï¼ˆç‰¹æ®Šæ–‡å­—ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
              const sanitizedWorkflowName = (workflowName || 'Unknown').replace(/[<>:"\/\\|?*]/g, '-');
              title = `[è‡ªå‹•ä¿®å¾©] ${sanitizedWorkflowName} å¤±æ•—æ¤œçŸ¥ãƒ»ä¿®å¾©è©¦è¡Œ (${dateStr})`;
            } else if (errorCount > 0) {
              title = `[è‡ªå‹•ä¿®å¾©] ã‚¨ãƒ©ãƒ¼${errorCount}ä»¶æ¤œå‡ºãƒ»ä¿®å¾©${fixCount}ä»¶å®Ÿè¡Œ (${dateStr})`;
            } else {
              title = `[è‡ªå‹•ä¿®å¾©] æ­£å¸¸å‹•ä½œç¢ºèª (${dateStr})`;
            }

            // Issueãƒ©ãƒ™ãƒ«
            let labels = errorCount > 0 ? ['auto-fix', 'error-detected'] : ['auto-fix', 'healthy'];
            if (eventName === 'workflow_run') {
              labels.push('workflow-triggered');
              if (workflowConclusion === 'failure' || workflowConclusion === 'timed_out') {
                labels.push('ci-failure');
              }
            }

            // Issueä½œæˆ
            const issue = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: title,
              body: reportBody,
              labels: labels
            });

            console.log('Issueä½œæˆå®Œäº†:', issue.data.html_url);

      - name: Artifactã«çµæœã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: error-fix-results-${{ github.run_number }}
          path: |
            error_fix_results.txt
            error_fix_report.md
            backend/logs/*.log
          retention-days: 30

      - name: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        if: always()
        run: |
          docker stop postgres redis || true
          docker rm postgres redis || true

      - name: æ¬¡å›å®Ÿè¡Œã¾ã§ã‚¹ãƒªãƒ¼ãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        if: false  # é€šå¸¸ã¯ç„¡åŠ¹ï¼ˆcronã§5åˆ†å¾Œã«å†å®Ÿè¡Œï¼‰
        run: |
          echo "æ¬¡å›å®Ÿè¡Œã¾ã§5åˆ†å¾…æ©Ÿ..."
          sleep 300
