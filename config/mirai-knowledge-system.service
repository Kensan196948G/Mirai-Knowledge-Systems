[Unit]
Description=Mirai Knowledge System - 建設土木ナレッジシステム
After=network.target

[Service]
Type=notify
User=kensan
Group=kensan
WorkingDirectory=/mnt/LinuxHDD/Mirai-Knowledge-Systems/backend
EnvironmentFile=/mnt/LinuxHDD/Mirai-Knowledge-Systems/backend/.env
Environment="PATH=/mnt/LinuxHDD/Mirai-Knowledge-Systems/backend/venv_linux/bin:/usr/local/bin:/usr/bin:/bin"
Environment="MKS_ENV=development"
Environment="MKS_DEBUG=false"
# Gunicornを使用してSocket.IOに対応（worker_class=gevent）
ExecStart=/mnt/LinuxHDD/Mirai-Knowledge-Systems/backend/venv_linux/bin/gunicorn --config /mnt/LinuxHDD/Mirai-Knowledge-Systems/backend/gunicorn.conf.py app_v2:app
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
SyslogIdentifier=mirai-knowledge

# セキュリティ設定
NoNewPrivileges=true
PrivateTmp=true

[Install]
WantedBy=multi-user.target
